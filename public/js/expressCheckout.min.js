!function(n){var t={};function e(g){if(t[g])return t[g].exports;var I=t[g]={i:g,l:!1,exports:{}};return n[g].call(I.exports,I,I.exports,e),I.l=!0,I.exports}e.m=n,e.c=t,e.d=function(n,t,g){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:g})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var g=Object.create(null);if(e.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var I in n)e.d(g,I,function(t){return n[t]}.bind(null,I));return g},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=2)}([function(module,exports){eval("/**\n * Build Redirect Url By Ajax Request\n *\n * @param response\n * @param defaultUrl\n * @returns {string|*|string}\n */\nfunction redirectUrlByRequest (response, defaultUrl = '')\n{\n  if (!'data' in response) {\n    return defaultUrl\n  }\n\n  const redirectUrl = ('redirectUrl' in response.data) ? response.data.redirectUrl : defaultUrl\n\n  return redirectUrl\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvdXRpbHMuanM/YTM0MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEJ1aWxkIFJlZGlyZWN0IFVybCBCeSBBamF4IFJlcXVlc3RcbiAqXG4gKiBAcGFyYW0gcmVzcG9uc2VcbiAqIEBwYXJhbSBkZWZhdWx0VXJsXG4gKiBAcmV0dXJucyB7c3RyaW5nfCp8c3RyaW5nfVxuICovXG5mdW5jdGlvbiByZWRpcmVjdFVybEJ5UmVxdWVzdCAocmVzcG9uc2UsIGRlZmF1bHRVcmwgPSAnJylcbntcbiAgaWYgKCEnZGF0YScgaW4gcmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVmYXVsdFVybFxuICB9XG5cbiAgY29uc3QgcmVkaXJlY3RVcmwgPSAoJ3JlZGlyZWN0VXJsJyBpbiByZXNwb25zZS5kYXRhKSA/IHJlc3BvbnNlLmRhdGEucmVkaXJlY3RVcmwgOiBkZWZhdWx0VXJsXG5cbiAgcmV0dXJuIHJlZGlyZWN0VXJsXG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n")},,function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/Request.js\n/**\n * Class Request\n *\n * @type {Request}\n */\nconst Request = class Request\n{\n  // TODO Make the fields private if possible.\n  constructor (ajaxUrl, action)\n  {\n    this.ajaxUrl = ajaxUrl\n    this.action = action\n  }\n\n  formDataObject (formData)\n  {\n    const formDataEntries = [...formData.entries(), ['action', this.action]]\n    const dataObject = formDataEntries.reduce((obj, [key, value]) => {\n      obj[key] = value\n      return obj\n    }, {})\n\n    return dataObject\n  }\n\n  submit (formData)\n  {\n    // TODO Extract specific data such as: action, nonce, task, context and\n    //      put the rest within a specific object.\n    //      Make a separation for data controls and real request data.\n\n    const dataObject = this.formDataObject(formData)\n\n    if (_.isEmpty(dataObject)) {\n      return Promise.reject('No formData to send to the server.')\n    }\n\n    return new Promise((resolve, reject) => {\n      jQuery.ajax({\n        url: this.ajaxUrl,\n        method: 'POST',\n        data: dataObject,\n        error: reject,\n        success: resolve\n      })\n    })\n  }\n}\n\n/**\n * Request Factory\n *\n * @param ajaxUrl\n * @param action\n * @returns {Request}\n */\nfunction RequestFactory (ajaxUrl, action)\n{\n  if (!ajaxUrl || !action) {\n    throw new Error('Invalid parameters when construct Request instance')\n  }\n\n  let object = new Request(ajaxUrl, action)\n  Object.freeze(object)\n\n  return object\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/context.js\n/**\n * Retrieve Context by Element\n *\n * @param element\n * @returns {string}\n */\nfunction contextByElement (element)\n{\n  return ('context' in element.dataset ? element.dataset.context : '')\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/form.js\n\n\nconst CART_BUTTON_SELECTOR = 'woo-paypalplus-checkout-nonce'\n\n/**\n * Create a FormData object by the closest form of the given element\n *\n * @param element\n * @returns {FormData}\n */\nfunction formDataByElement (element)\n{\n  const form = element.closest('form')\n\n  if (!form) {\n    throw new Error(\n      'Unable to retrieve form. Form element does not exists or is not a parent of the given element.'\n    )\n  }\n\n  const formData = new FormData(form)\n  formData.append('context', contextByElement(element))\n\n  return formData\n}\n\n/**\n * Create a FormData for the Cart\n * WooCommerce mini cart doesn't have any form associated with it\n *\n * @param element\n * @returns {FormData}\n */\nfunction formDataForCart (element)\n{\n  try {\n    const [nonceName, nonceValue] = retrieveNonceForCart(element)\n    const formData = new FormData()\n\n    formData.append('context', contextByElement(element))\n    formData.append(nonceName, nonceValue)\n\n    return formData\n  } catch (err) {\n    return new FormData()\n  }\n}\n\nfunction retrieveNonceForCart (element)\n{\n  const nonceElement = element.parentNode.querySelector(`.${CART_BUTTON_SELECTOR}`)\n\n  if (!nonceElement) {\n    throw new Error('Cannot build the form data, missing security nonce.')\n  }\n\n  const nonceName = ('noncename' in nonceElement.dataset) ? nonceElement.dataset.noncename : ''\n  const nonceValue = ('noncevalue' in nonceElement.dataset) ? nonceElement.dataset.noncevalue : ''\n\n  if (!nonceName || !nonceValue) {\n    throw new Error('Cannot build the form data, missing security nonce.')\n  }\n\n  return [\n    nonceName,\n    nonceValue\n  ]\n}\n\n// EXTERNAL MODULE: ./resources/js/utils.js\nvar utils = __webpack_require__(0);\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/smartPaymentButton.js\n\n\n\n\nconst SINGLE_PRODUCT_BUTTON = 'paypalplus_ecs_single_product_button'\nconst CART_BUTTON = 'paypalplus_ecs_cart_button'\n\nconst TASK_CREATE_ORDER = 'createOrder'\nconst TASK_STORE_PAYMENT_DATA = 'storePaymentData'\n\n/**\n * Class Smart Payment Button Renderer\n *\n * @type {SmartPaymentButtonRenderer}\n */\nconst smartPaymentButton_SmartPaymentButtonRenderer = class SmartPaymentButtonRenderer\n{\n  /**\n   * Constructor\n   *\n   * @param buttonConfiguration\n   * @param validContexts\n   * @param request\n   */\n  constructor (buttonConfiguration, validContexts, request)\n  {\n    this.buttonConfiguration = buttonConfiguration\n    this.cancelUrl = this.buttonConfiguration.redirect_urls.cancel_url\n    this.validContexts = Array.from(validContexts)\n    this.request = request\n  }\n\n  /**\n   * Render button for single product\n   */\n  singleProductButtonRender ()\n  {\n    const element = document.querySelector(`#${SINGLE_PRODUCT_BUTTON}`)\n    element && this.render(element)\n  }\n\n  /**\n   * Render Button for Cart\n   */\n  cartButtonRender ()\n  {\n    const element = document.querySelector(`#${CART_BUTTON}`)\n    element && this.render(element)\n  }\n\n  /**\n   * Render Button for the Given Element\n   *\n   * @param element\n   * @returns {*}\n   */\n  // TODO Make it private\n  render (element)\n  {\n    if (_.isUndefined(paypal)) {\n      return\n    }\n\n    const button = element.querySelector('.paypal-button')\n    button && button.remove()\n\n    paypal.Button.render({\n      ...this.buttonConfiguration,\n\n      /**\n       * Do Payment\n       *\n       * @returns {*}\n       */\n      payment: () => {\n        const formData = this.formDataByElement(element)\n        formData.append('task', TASK_CREATE_ORDER)\n\n        formData.delete('add-to-cart')\n\n        return this.request\n          .submit(formData)\n          .then(response => {\n            if (!'data' in response) {\n              console.warn('Unable to process the payment, server did not response with valid data')\n              try {\n                window.location = this.cancelUrl\n              } catch (e) {\n                return\n              }\n            }\n\n            if (!response.success) {\n              try {\n                window.location = utils[\"redirectUrlByRequest\"](response, this.cancelUrl)\n              } catch (e) {\n                return\n              }\n            }\n\n            const orderId = 'orderId' in response.data ? response.data.orderId : ''\n\n            if (!orderId) {\n              try {\n                window.location = utils[\"redirectUrlByRequest\"](response, this.cancelUrl)\n              } catch (e) {\n                return\n              }\n            }\n\n            return orderId\n          })\n          .catch(error => {\n            const textStatus = 'textStatus' in error ? error.textStatus : 'Unknown Error during payment'\n            console.warn(textStatus)\n          })\n      },\n\n      /**\n       * Execute Authorization\n       *\n       * @param data\n       * @param actions\n       * @returns {*}\n       */\n      onAuthorize: (data, actions) => {\n        // TODO Ensure return_url exists.\n        const formData = this.formDataByElement(element)\n\n        formData.append('task', TASK_STORE_PAYMENT_DATA)\n        formData.append('orderId', data.orderID)\n        formData.append('PayerID', data.payerID)\n        formData.append('paymentId', data.paymentID)\n        formData.append('token', data.paymentToken)\n\n        formData.delete('add-to-cart')\n\n        return this.request\n          .submit(formData)\n          .then((response) => {\n\n            if (!response.success) {\n              try {\n                window.location = utils[\"redirectUrlByRequest\"](response, this.cancelUrl)\n              } catch (e) {\n                return\n              }\n            }\n\n            let returnUrl = ''\n\n            if ('redirect_urls' in this.buttonConfiguration\n              && 'return_url' in this.buttonConfiguration.redirect_urls\n            ) {\n              returnUrl = this.buttonConfiguration.redirect_urls.return_url\n            }\n\n            returnUrl && actions.redirect(null, returnUrl)\n          })\n      },\n\n      /**\n       * Perform Action when a Payment get Cancelled\n       *\n       * @param data\n       * @param actions\n       */\n      onCancel: (data, actions) => {\n        actions.close()\n        const cancelUrl = 'cancelUrl' in data ? data.cancelUrl : ''\n        cancelUrl && actions.redirect(null, cancelUrl)\n      },\n\n      onError: (data, actions) => {\n        console.log('ON ERROR', data, actions)\n        // TODO Redirect to cart and show customizable notice with message.\n      }\n\n    }, element)\n  }\n\n  /**\n   * Retrieve context for FormData instance by the Given Element\n   *\n   * @param element\n   * @returns {FormData}\n   */\n  // TODO Make it private if not possible move it as closure within the render function.\n  formDataByElement (element)\n  {\n    let formData = new FormData()\n    const context = contextByElement(element)\n\n    if (!this.validContexts.includes(context)) {\n      throw new Error(\n        'Invalid context when try to retrieve the form data during express checkout request.'\n      )\n    }\n\n    try {\n      switch (context) {\n        case 'cart':\n          formData = formDataForCart(element)\n          break\n        case 'product':\n          formData = formDataByElement(element)\n          break\n      }\n    } catch (err) {\n    }\n\n    return formData\n  }\n}\n\n/**\n * Smart Payment Button Renderer Factory\n *\n * @param buttonConfiguration\n * @param validContexts\n * @param request\n * @returns {SmartPaymentButtonRenderer}\n * @constructor\n */\nfunction SmartPaymentButtonRendererFactory (buttonConfiguration, validContexts, request)\n{\n  const object = new smartPaymentButton_SmartPaymentButtonRenderer(buttonConfiguration, validContexts, request)\n\n  Object.freeze(object)\n\n  return object\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout.js\n\n\n\n(function (jQuery, _, expressCheckoutData) {\n  /**\n   * Ensure the Global Express Checkout is a Valid Value\n   * @returns {boolean}\n   */\n  function isValidExpressCheckoutData ()\n  {\n    return !_.isUndefined(expressCheckoutData) && !_.isEmpty(expressCheckoutData)\n  }\n\n  /**\n   * Bootstrap Express checkout\n   * @returns void\n   */\n  function bootstrapExpressCheckout ()\n  {\n    if (!isValidExpressCheckoutData()) {\n      return\n    }\n\n    const requestData = expressCheckoutData.request\n    if (!_.isObject(requestData)) {\n      return\n    }\n\n    const validContexts = expressCheckoutData.validContexts\n    if (!_.isArray(validContexts)) {\n      return\n    }\n\n    const request = RequestFactory(requestData.ajaxUrl, requestData.action)\n    const smartPaymentButton = SmartPaymentButtonRendererFactory(\n      expressCheckoutData,\n      validContexts,\n      request\n    )\n\n    smartPaymentButton.singleProductButtonRender()\n    smartPaymentButton.cartButtonRender()\n    jQuery(document.body).on('wc_fragments_refreshed wc_fragments_loaded removed_from_cart added_to_cart', () => {\n      smartPaymentButton.cartButtonRender()\n    })\n  }\n\n  window.addEventListener('load', () => {\n    bootstrapExpressCheckout()\n  })\n})(jQuery, window._, window.wooPayPalPlusExpressCheckout)\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L1JlcXVlc3QuanM/OGQ1ZiIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L2NvbnRleHQuanM/NjhkMyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L2Zvcm0uanM/ZWE1ZCIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L3NtYXJ0UGF5bWVudEJ1dHRvbi5qcz9mM2IyIiwid2VicGFjazovLy8uL3Jlc291cmNlcy9qcy9leHByZXNzQ2hlY2tvdXQuanM/ZGNjMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssSUFBSTs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ087QUFDUDtBQUNBO0FBQ0E7OztBQ1Q0Qzs7QUFFNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDZCQUE2QixnQkFBZ0I7O0FBRTdDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFB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c3RcbiAqXG4gKiBAdHlwZSB7UmVxdWVzdH1cbiAqL1xuY29uc3QgUmVxdWVzdCA9IGNsYXNzIFJlcXVlc3RcbntcbiAgLy8gVE9ETyBNYWtlIHRoZSBmaWVsZHMgcHJpdmF0ZSBpZiBwb3NzaWJsZS5cbiAgY29uc3RydWN0b3IgKGFqYXhVcmwsIGFjdGlvbilcbiAge1xuICAgIHRoaXMuYWpheFVybCA9IGFqYXhVcmxcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvblxuICB9XG5cbiAgZm9ybURhdGFPYmplY3QgKGZvcm1EYXRhKVxuICB7XG4gICAgY29uc3QgZm9ybURhdGFFbnRyaWVzID0gWy4uLmZvcm1EYXRhLmVudHJpZXMoKSwgWydhY3Rpb24nLCB0aGlzLmFjdGlvbl1dXG4gICAgY29uc3QgZGF0YU9iamVjdCA9IGZvcm1EYXRhRW50cmllcy5yZWR1Y2UoKG9iaiwgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBvYmpba2V5XSA9IHZhbHVlXG4gICAgICByZXR1cm4gb2JqXG4gICAgfSwge30pXG5cbiAgICByZXR1cm4gZGF0YU9iamVjdFxuICB9XG5cbiAgc3VibWl0IChmb3JtRGF0YSlcbiAge1xuICAgIC8vIFRPRE8gRXh0cmFjdCBzcGVjaWZpYyBkYXRhIHN1Y2ggYXM6IGFjdGlvbiwgbm9uY2UsIHRhc2ssIGNvbnRleHQgYW5kXG4gICAgLy8gICAgICBwdXQgdGhlIHJlc3Qgd2l0aGluIGEgc3BlY2lmaWMgb2JqZWN0LlxuICAgIC8vICAgICAgTWFrZSBhIHNlcGFyYXRpb24gZm9yIGRhdGEgY29udHJvbHMgYW5kIHJlYWwgcmVxdWVzdCBkYXRhLlxuXG4gICAgY29uc3QgZGF0YU9iamVjdCA9IHRoaXMuZm9ybURhdGFPYmplY3QoZm9ybURhdGEpXG5cbiAgICBpZiAoXy5pc0VtcHR5KGRhdGFPYmplY3QpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05vIGZvcm1EYXRhIHRvIHNlbmQgdG8gdGhlIHNlcnZlci4nKVxuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgIHVybDogdGhpcy5hamF4VXJsLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgZGF0YTogZGF0YU9iamVjdCxcbiAgICAgICAgZXJyb3I6IHJlamVjdCxcbiAgICAgICAgc3VjY2VzczogcmVzb2x2ZVxuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5cbi8qKlxuICogUmVxdWVzdCBGYWN0b3J5XG4gKlxuICogQHBhcmFtIGFqYXhVcmxcbiAqIEBwYXJhbSBhY3Rpb25cbiAqIEByZXR1cm5zIHtSZXF1ZXN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gUmVxdWVzdEZhY3RvcnkgKGFqYXhVcmwsIGFjdGlvbilcbntcbiAgaWYgKCFhamF4VXJsIHx8ICFhY3Rpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcGFyYW1ldGVycyB3aGVuIGNvbnN0cnVjdCBSZXF1ZXN0IGluc3RhbmNlJylcbiAgfVxuXG4gIGxldCBvYmplY3QgPSBuZXcgUmVxdWVzdChhamF4VXJsLCBhY3Rpb24pXG4gIE9iamVjdC5mcmVlemUob2JqZWN0KVxuXG4gIHJldHVybiBvYmplY3Rcbn1cbiIsIi8qKlxuICogUmV0cmlldmUgQ29udGV4dCBieSBFbGVtZW50XG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb250ZXh0QnlFbGVtZW50IChlbGVtZW50KVxue1xuICByZXR1cm4gKCdjb250ZXh0JyBpbiBlbGVtZW50LmRhdGFzZXQgPyBlbGVtZW50LmRhdGFzZXQuY29udGV4dCA6ICcnKVxufVxuIiwiaW1wb3J0IHsgY29udGV4dEJ5RWxlbWVudCB9IGZyb20gJy4vY29udGV4dCdcblxuY29uc3QgQ0FSVF9CVVRUT05fU0VMRUNUT1IgPSAnd29vLXBheXBhbHBsdXMtY2hlY2tvdXQtbm9uY2UnXG5cbi8qKlxuICogQ3JlYXRlIGEgRm9ybURhdGEgb2JqZWN0IGJ5IHRoZSBjbG9zZXN0IGZvcm0gb2YgdGhlIGdpdmVuIGVsZW1lbnRcbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHJldHVybnMge0Zvcm1EYXRhfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybURhdGFCeUVsZW1lbnQgKGVsZW1lbnQpXG57XG4gIGNvbnN0IGZvcm0gPSBlbGVtZW50LmNsb3Nlc3QoJ2Zvcm0nKVxuXG4gIGlmICghZm9ybSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdVbmFibGUgdG8gcmV0cmlldmUgZm9ybS4gRm9ybSBlbGVtZW50IGRvZXMgbm90IGV4aXN0cyBvciBpcyBub3QgYSBwYXJlbnQgb2YgdGhlIGdpdmVuIGVsZW1lbnQuJ1xuICAgIClcbiAgfVxuXG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pXG4gIGZvcm1EYXRhLmFwcGVuZCgnY29udGV4dCcsIGNvbnRleHRCeUVsZW1lbnQoZWxlbWVudCkpXG5cbiAgcmV0dXJuIGZvcm1EYXRhXG59XG5cbi8qKlxuICogQ3JlYXRlIGEgRm9ybURhdGEgZm9yIHRoZSBDYXJ0XG4gKiBXb29Db21tZXJjZSBtaW5pIGNhcnQgZG9lc24ndCBoYXZlIGFueSBmb3JtIGFzc29jaWF0ZWQgd2l0aCBpdFxuICpcbiAqIEBwYXJhbSBlbGVtZW50XG4gKiBAcmV0dXJucyB7Rm9ybURhdGF9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtRGF0YUZvckNhcnQgKGVsZW1lbnQpXG57XG4gIHRyeSB7XG4gICAgY29uc3QgW25vbmNlTmFtZSwgbm9uY2VWYWx1ZV0gPSByZXRyaWV2ZU5vbmNlRm9yQ2FydChlbGVtZW50KVxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKClcblxuICAgIGZvcm1EYXRhLmFwcGVuZCgnY29udGV4dCcsIGNvbnRleHRCeUVsZW1lbnQoZWxlbWVudCkpXG4gICAgZm9ybURhdGEuYXBwZW5kKG5vbmNlTmFtZSwgbm9uY2VWYWx1ZSlcblxuICAgIHJldHVybiBmb3JtRGF0YVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV3IEZvcm1EYXRhKClcbiAgfVxufVxuXG5mdW5jdGlvbiByZXRyaWV2ZU5vbmNlRm9yQ2FydCAoZWxlbWVudClcbntcbiAgY29uc3Qgbm9uY2VFbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoYC4ke0NBUlRfQlVUVE9OX1NFTEVDVE9SfWApXG5cbiAgaWYgKCFub25jZUVsZW1lbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBidWlsZCB0aGUgZm9ybSBkYXRhLCBtaXNzaW5nIHNlY3VyaXR5IG5vbmNlLicpXG4gIH1cblxuICBjb25zdCBub25jZU5hbWUgPSAoJ25vbmNlbmFtZScgaW4gbm9uY2VFbGVtZW50LmRhdGFzZXQpID8gbm9uY2VFbGVtZW50LmRhdGFzZXQubm9uY2VuYW1lIDogJydcbiAgY29uc3Qgbm9uY2VWYWx1ZSA9ICgnbm9uY2V2YWx1ZScgaW4gbm9uY2VFbGVtZW50LmRhdGFzZXQpID8gbm9uY2VFbGVtZW50LmRhdGFzZXQubm9uY2V2YWx1ZSA6ICcnXG5cbiAgaWYgKCFub25jZU5hbWUgfHwgIW5vbmNlVmFsdWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBidWlsZCB0aGUgZm9ybSBkYXRhLCBtaXNzaW5nIHNlY3VyaXR5IG5vbmNlLicpXG4gIH1cblxuICByZXR1cm4gW1xuICAgIG5vbmNlTmFtZSxcbiAgICBub25jZVZhbHVlXG4gIF1cbn1cbiIsImltcG9ydCB7IGZvcm1EYXRhQnlFbGVtZW50LCBmb3JtRGF0YUZvckNhcnQgfSBmcm9tICcuL2Zvcm0nXG5pbXBvcnQgeyBjb250ZXh0QnlFbGVtZW50IH0gZnJvbSAnLi9jb250ZXh0J1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSAnLi4vdXRpbHMnXG5cbmNvbnN0IFNJTkdMRV9QUk9EVUNUX0JVVFRPTiA9ICdwYXlwYWxwbHVzX2Vjc19zaW5nbGVfcHJvZHVjdF9idXR0b24nXG5jb25zdCBDQVJUX0JVVFRPTiA9ICdwYXlwYWxwbHVzX2Vjc19jYXJ0X2J1dHRvbidcblxuY29uc3QgVEFTS19DUkVBVEVfT1JERVIgPSAnY3JlYXRlT3JkZXInXG5jb25zdCBUQVNLX1NUT1JFX1BBWU1FTlRfREFUQSA9ICdzdG9yZVBheW1lbnREYXRhJ1xuXG4vKipcbiAqIENsYXNzIFNtYXJ0IFBheW1lbnQgQnV0dG9uIFJlbmRlcmVyXG4gKlxuICogQHR5cGUge1NtYXJ0UGF5bWVudEJ1dHRvblJlbmRlcmVyfVxuICovXG5jb25zdCBTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlciA9IGNsYXNzIFNtYXJ0UGF5bWVudEJ1dHRvblJlbmRlcmVyXG57XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RvclxuICAgKlxuICAgKiBAcGFyYW0gYnV0dG9uQ29uZmlndXJhdGlvblxuICAgKiBAcGFyYW0gdmFsaWRDb250ZXh0c1xuICAgKiBAcGFyYW0gcmVxdWVzdFxuICAgKi9cbiAgY29uc3RydWN0b3IgKGJ1dHRvbkNvbmZpZ3VyYXRpb24sIHZhbGlkQ29udGV4dHMsIHJlcXVlc3QpXG4gIHtcbiAgICB0aGlzLmJ1dHRvbkNvbmZpZ3VyYXRpb24gPSBidXR0b25Db25maWd1cmF0aW9uXG4gICAgdGhpcy5jYW5jZWxVcmwgPSB0aGlzLmJ1dHRvbkNvbmZpZ3VyYXRpb24ucmVkaXJlY3RfdXJscy5jYW5jZWxfdXJsXG4gICAgdGhpcy52YWxpZENvbnRleHRzID0gQXJyYXkuZnJvbSh2YWxpZENvbnRleHRzKVxuICAgIHRoaXMucmVxdWVzdCA9IHJlcXVlc3RcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgYnV0dG9uIGZvciBzaW5nbGUgcHJvZHVjdFxuICAgKi9cbiAgc2luZ2xlUHJvZHVjdEJ1dHRvblJlbmRlciAoKVxuICB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke1NJTkdMRV9QUk9EVUNUX0JVVFRPTn1gKVxuICAgIGVsZW1lbnQgJiYgdGhpcy5yZW5kZXIoZWxlbWVudClcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgQnV0dG9uIGZvciBDYXJ0XG4gICAqL1xuICBjYXJ0QnV0dG9uUmVuZGVyICgpXG4gIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Q0FSVF9CVVRUT059YClcbiAgICBlbGVtZW50ICYmIHRoaXMucmVuZGVyKGVsZW1lbnQpXG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIEJ1dHRvbiBmb3IgdGhlIEdpdmVuIEVsZW1lbnRcbiAgICpcbiAgICogQHBhcmFtIGVsZW1lbnRcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICAvLyBUT0RPIE1ha2UgaXQgcHJpdmF0ZVxuICByZW5kZXIgKGVsZW1lbnQpXG4gIHtcbiAgICBpZiAoXy5pc1VuZGVmaW5lZChwYXlwYWwpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBidXR0b24gPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXlwYWwtYnV0dG9uJylcbiAgICBidXR0b24gJiYgYnV0dG9uLnJlbW92ZSgpXG5cbiAgICBwYXlwYWwuQnV0dG9uLnJlbmRlcih7XG4gICAgICAuLi50aGlzLmJ1dHRvbkNvbmZpZ3VyYXRpb24sXG5cbiAgICAgIC8qKlxuICAgICAgICogRG8gUGF5bWVudFxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICovXG4gICAgICBwYXltZW50OiAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YUJ5RWxlbWVudChlbGVtZW50KVxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3Rhc2snLCBUQVNLX0NSRUFURV9PUkRFUilcblxuICAgICAgICBmb3JtRGF0YS5kZWxldGUoJ2FkZC10by1jYXJ0JylcblxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0XG4gICAgICAgICAgLnN1Ym1pdChmb3JtRGF0YSlcbiAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAoISdkYXRhJyBpbiByZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1VuYWJsZSB0byBwcm9jZXNzIHRoZSBwYXltZW50LCBzZXJ2ZXIgZGlkIG5vdCByZXNwb25zZSB3aXRoIHZhbGlkIGRhdGEnKVxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHRoaXMuY2FuY2VsVXJsXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB1dGlscy5yZWRpcmVjdFVybEJ5UmVxdWVzdChyZXNwb25zZSwgdGhpcy5jYW5jZWxVcmwpXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBvcmRlcklkID0gJ29yZGVySWQnIGluIHJlc3BvbnNlLmRhdGEgPyByZXNwb25zZS5kYXRhLm9yZGVySWQgOiAnJ1xuXG4gICAgICAgICAgICBpZiAoIW9yZGVySWQpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB1dGlscy5yZWRpcmVjdFVybEJ5UmVxdWVzdChyZXNwb25zZSwgdGhpcy5jYW5jZWxVcmwpXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb3JkZXJJZFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRleHRTdGF0dXMgPSAndGV4dFN0YXR1cycgaW4gZXJyb3IgPyBlcnJvci50ZXh0U3RhdHVzIDogJ1Vua25vd24gRXJyb3IgZHVyaW5nIHBheW1lbnQnXG4gICAgICAgICAgICBjb25zb2xlLndhcm4odGV4dFN0YXR1cylcbiAgICAgICAgICB9KVxuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBFeGVjdXRlIEF1dGhvcml6YXRpb25cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAgICogQHBhcmFtIGFjdGlvbnNcbiAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICovXG4gICAgICBvbkF1dGhvcml6ZTogKGRhdGEsIGFjdGlvbnMpID0+IHtcbiAgICAgICAgLy8gVE9ETyBFbnN1cmUgcmV0dXJuX3VybCBleGlzdHMuXG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YUJ5RWxlbWVudChlbGVtZW50KVxuXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGFzaycsIFRBU0tfU1RPUkVfUEFZTUVOVF9EQVRBKVxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ29yZGVySWQnLCBkYXRhLm9yZGVySUQpXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnUGF5ZXJJRCcsIGRhdGEucGF5ZXJJRClcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwYXltZW50SWQnLCBkYXRhLnBheW1lbnRJRClcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd0b2tlbicsIGRhdGEucGF5bWVudFRva2VuKVxuXG4gICAgICAgIGZvcm1EYXRhLmRlbGV0ZSgnYWRkLXRvLWNhcnQnKVxuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RcbiAgICAgICAgICAuc3VibWl0KGZvcm1EYXRhKVxuICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB1dGlscy5yZWRpcmVjdFVybEJ5UmVxdWVzdChyZXNwb25zZSwgdGhpcy5jYW5jZWxVcmwpXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgcmV0dXJuVXJsID0gJydcblxuICAgICAgICAgICAgaWYgKCdyZWRpcmVjdF91cmxzJyBpbiB0aGlzLmJ1dHRvbkNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgICAgJiYgJ3JldHVybl91cmwnIGluIHRoaXMuYnV0dG9uQ29uZmlndXJhdGlvbi5yZWRpcmVjdF91cmxzXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgcmV0dXJuVXJsID0gdGhpcy5idXR0b25Db25maWd1cmF0aW9uLnJlZGlyZWN0X3VybHMucmV0dXJuX3VybFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm5VcmwgJiYgYWN0aW9ucy5yZWRpcmVjdChudWxsLCByZXR1cm5VcmwpXG4gICAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogUGVyZm9ybSBBY3Rpb24gd2hlbiBhIFBheW1lbnQgZ2V0IENhbmNlbGxlZFxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgKiBAcGFyYW0gYWN0aW9uc1xuICAgICAgICovXG4gICAgICBvbkNhbmNlbDogKGRhdGEsIGFjdGlvbnMpID0+IHtcbiAgICAgICAgYWN0aW9ucy5jbG9zZSgpXG4gICAgICAgIGNvbnN0IGNhbmNlbFVybCA9ICdjYW5jZWxVcmwnIGluIGRhdGEgPyBkYXRhLmNhbmNlbFVybCA6ICcnXG4gICAgICAgIGNhbmNlbFVybCAmJiBhY3Rpb25zLnJlZGlyZWN0KG51bGwsIGNhbmNlbFVybClcbiAgICAgIH0sXG5cbiAgICAgIG9uRXJyb3I6IChkYXRhLCBhY3Rpb25zKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdPTiBFUlJPUicsIGRhdGEsIGFjdGlvbnMpXG4gICAgICAgIC8vIFRPRE8gUmVkaXJlY3QgdG8gY2FydCBhbmQgc2hvdyBjdXN0b21pemFibGUgbm90aWNlIHdpdGggbWVzc2FnZS5cbiAgICAgIH1cblxuICAgIH0sIGVsZW1lbnQpXG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgY29udGV4dCBmb3IgRm9ybURhdGEgaW5zdGFuY2UgYnkgdGhlIEdpdmVuIEVsZW1lbnRcbiAgICpcbiAgICogQHBhcmFtIGVsZW1lbnRcbiAgICogQHJldHVybnMge0Zvcm1EYXRhfVxuICAgKi9cbiAgLy8gVE9ETyBNYWtlIGl0IHByaXZhdGUgaWYgbm90IHBvc3NpYmxlIG1vdmUgaXQgYXMgY2xvc3VyZSB3aXRoaW4gdGhlIHJlbmRlciBmdW5jdGlvbi5cbiAgZm9ybURhdGFCeUVsZW1lbnQgKGVsZW1lbnQpXG4gIHtcbiAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKVxuICAgIGNvbnN0IGNvbnRleHQgPSBjb250ZXh0QnlFbGVtZW50KGVsZW1lbnQpXG5cbiAgICBpZiAoIXRoaXMudmFsaWRDb250ZXh0cy5pbmNsdWRlcyhjb250ZXh0KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnSW52YWxpZCBjb250ZXh0IHdoZW4gdHJ5IHRvIHJldHJpZXZlIHRoZSBmb3JtIGRhdGEgZHVyaW5nIGV4cHJlc3MgY2hlY2tvdXQgcmVxdWVzdC4nXG4gICAgICApXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHN3aXRjaCAoY29udGV4dCkge1xuICAgICAgICBjYXNlICdjYXJ0JzpcbiAgICAgICAgICBmb3JtRGF0YSA9IGZvcm1EYXRhRm9yQ2FydChlbGVtZW50KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ3Byb2R1Y3QnOlxuICAgICAgICAgIGZvcm1EYXRhID0gZm9ybURhdGFCeUVsZW1lbnQoZWxlbWVudClcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgIH1cblxuICAgIHJldHVybiBmb3JtRGF0YVxuICB9XG59XG5cbi8qKlxuICogU21hcnQgUGF5bWVudCBCdXR0b24gUmVuZGVyZXIgRmFjdG9yeVxuICpcbiAqIEBwYXJhbSBidXR0b25Db25maWd1cmF0aW9uXG4gKiBAcGFyYW0gdmFsaWRDb250ZXh0c1xuICogQHBhcmFtIHJlcXVlc3RcbiAqIEByZXR1cm5zIHtTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlcn1cbiAqIEBjb25zdHJ1Y3RvclxuICovXG5leHBvcnQgZnVuY3Rpb24gU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXJGYWN0b3J5IChidXR0b25Db25maWd1cmF0aW9uLCB2YWxpZENvbnRleHRzLCByZXF1ZXN0KVxue1xuICBjb25zdCBvYmplY3QgPSBuZXcgU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXIoYnV0dG9uQ29uZmlndXJhdGlvbiwgdmFsaWRDb250ZXh0cywgcmVxdWVzdClcblxuICBPYmplY3QuZnJlZXplKG9iamVjdClcblxuICByZXR1cm4gb2JqZWN0XG59XG4iLCJpbXBvcnQgeyBSZXF1ZXN0RmFjdG9yeSB9IGZyb20gJy4vZXhwcmVzc0NoZWNrb3V0L1JlcXVlc3QnXG5pbXBvcnQgeyBTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlckZhY3RvcnkgfSBmcm9tICcuL2V4cHJlc3NDaGVja291dC9zbWFydFBheW1lbnRCdXR0b24nXG5cbihmdW5jdGlvbiAoalF1ZXJ5LCBfLCBleHByZXNzQ2hlY2tvdXREYXRhKSB7XG4gIC8qKlxuICAgKiBFbnN1cmUgdGhlIEdsb2JhbCBFeHByZXNzIENoZWNrb3V0IGlzIGEgVmFsaWQgVmFsdWVcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBmdW5jdGlvbiBpc1ZhbGlkRXhwcmVzc0NoZWNrb3V0RGF0YSAoKVxuICB7XG4gICAgcmV0dXJuICFfLmlzVW5kZWZpbmVkKGV4cHJlc3NDaGVja291dERhdGEpICYmICFfLmlzRW1wdHkoZXhwcmVzc0NoZWNrb3V0RGF0YSlcbiAgfVxuXG4gIC8qKlxuICAgKiBCb290c3RyYXAgRXhwcmVzcyBjaGVja291dFxuICAgKiBAcmV0dXJucyB2b2lkXG4gICAqL1xuICBmdW5jdGlvbiBib290c3RyYXBFeHByZXNzQ2hlY2tvdXQgKClcbiAge1xuICAgIGlmICghaXNWYWxpZEV4cHJlc3NDaGVja291dERhdGEoKSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgcmVxdWVzdERhdGEgPSBleHByZXNzQ2hlY2tvdXREYXRhLnJlcXVlc3RcbiAgICBpZiAoIV8uaXNPYmplY3QocmVxdWVzdERhdGEpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCB2YWxpZENvbnRleHRzID0gZXhwcmVzc0NoZWNrb3V0RGF0YS52YWxpZENvbnRleHRzXG4gICAgaWYgKCFfLmlzQXJyYXkodmFsaWRDb250ZXh0cykpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHJlcXVlc3QgPSBSZXF1ZXN0RmFjdG9yeShyZXF1ZXN0RGF0YS5hamF4VXJsLCByZXF1ZXN0RGF0YS5hY3Rpb24pXG4gICAgY29uc3Qgc21hcnRQYXltZW50QnV0dG9uID0gU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXJGYWN0b3J5KFxuICAgICAgZXhwcmVzc0NoZWNrb3V0RGF0YSxcbiAgICAgIHZhbGlkQ29udGV4dHMsXG4gICAgICByZXF1ZXN0XG4gICAgKVxuXG4gICAgc21hcnRQYXltZW50QnV0dG9uLnNpbmdsZVByb2R1Y3RCdXR0b25SZW5kZXIoKVxuICAgIHNtYXJ0UGF5bWVudEJ1dHRvbi5jYXJ0QnV0dG9uUmVuZGVyKClcbiAgICBqUXVlcnkoZG9jdW1lbnQuYm9keSkub24oJ3djX2ZyYWdtZW50c19yZWZyZXNoZWQgd2NfZnJhZ21lbnRzX2xvYWRlZCByZW1vdmVkX2Zyb21fY2FydCBhZGRlZF90b19jYXJ0JywgKCkgPT4ge1xuICAgICAgc21hcnRQYXltZW50QnV0dG9uLmNhcnRCdXR0b25SZW5kZXIoKVxuICAgIH0pXG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICBib290c3RyYXBFeHByZXNzQ2hlY2tvdXQoKVxuICB9KVxufSkoalF1ZXJ5LCB3aW5kb3cuXywgd2luZG93Lndvb1BheVBhbFBsdXNFeHByZXNzQ2hlY2tvdXQpXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2\n")}]);
//# sourceMappingURL=expressCheckout.min.js.map