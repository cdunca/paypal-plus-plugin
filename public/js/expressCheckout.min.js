!function(n){var g={};function I(t){if(g[t])return g[t].exports;var C=g[t]={i:t,l:!1,exports:{}};return n[t].call(C.exports,C,C.exports,I),C.l=!0,C.exports}I.m=n,I.c=g,I.d=function(n,g,t){I.o(n,g)||Object.defineProperty(n,g,{enumerable:!0,get:t})},I.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},I.t=function(n,g){if(1&g&&(n=I(n)),8&g)return n;if(4&g&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(I.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&g&&"string"!=typeof n)for(var C in n)I.d(t,C,function(g){return n[g]}.bind(null,C));return t},I.n=function(n){var g=n&&n.__esModule?function(){return n.default}:function(){return n};return I.d(g,"a",g),g},I.o=function(n,g){return Object.prototype.hasOwnProperty.call(n,g)},I.p="",I(I.s=1)}([,function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/Request.js\n/**\n * Class Request\n *\n * @type {Request}\n */\nconst Request = class Request\n{\n    // TODO Make the fields private if possible.\n    constructor(ajaxUrl, action)\n    {\n        this.ajaxUrl = ajaxUrl;\n        this.action = action;\n    }\n\n    formDataObject(formData)\n    {\n        const formDataEntries = [...formData.entries(), ['action', this.action]];\n        const dataObject = formDataEntries.reduce((obj, [key, value]) => {\n            obj[key] = value;\n            return obj;\n        }, {});\n\n        return dataObject;\n    }\n\n    submit(formData)\n    {\n        // TODO Extract specific data such as: action, nonce, task, context and\n        //      put the rest within a specific object.\n        //      Make a separation for data controls and real request data.\n\n        const dataObject = this.formDataObject(formData);\n\n        if (_.isEmpty(dataObject)) {\n            return Promise.reject('No formData to send to the server.');\n        }\n\n        return new Promise((resolve, reject) => {\n            jQuery.ajax({\n                url: this.ajaxUrl,\n                method: 'POST',\n                data: dataObject,\n                error: reject,\n                success: resolve,\n            });\n        });\n    }\n};\n\n/**\n * Request Factory\n *\n * @param ajaxUrl\n * @param action\n * @returns {Request}\n */\nfunction RequestFactory(ajaxUrl, action)\n{\n    if (!ajaxUrl || !action) {\n        throw new Error('Invalid parameters when construct Request instance');\n    }\n\n    let object = new Request(ajaxUrl, action);\n    Object.freeze(object);\n\n    return object;\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/context.js\n/**\n * Retrieve Context by Element\n *\n * @param element\n * @returns {string}\n */\nfunction contextByElement(element)\n{\n    return ('context' in element.dataset ? element.dataset.context : '');\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/form.js\n\n\nconst CART_BUTTON_SELECTOR = 'woo-paypalplus-checkout-nonce';\n\n/**\n * Create a FormData object by the closest form of the given element\n *\n * @param element\n * @returns {FormData}\n */\nfunction formDataByElement(element)\n{\n    const form = element.closest('form');\n\n    if (!form) {\n        throw new Error(\n            'Unable to retrieve form. Form element does not exists or is not a parent of the given element.'\n        );\n    }\n\n    const formData = new FormData(form);\n    formData.append('context', contextByElement(element));\n\n    return formData;\n}\n\n/**\n * Create a FormData for the Cart\n * WooCommerce mini cart doesn't have any form associated with it\n *\n * @param element\n * @returns {FormData}\n */\nfunction formDataForCart(element)\n{\n    try {\n        const [nonceName, nonceValue] = retrieveNonceForCart(element);\n        const formData = new FormData();\n\n        formData.append('context', contextByElement(element));\n        formData.append(nonceName, nonceValue);\n\n        return formData;\n    } catch (err) {\n        return new FormData();\n    }\n}\n\nfunction retrieveNonceForCart(element)\n{\n    const nonceElement = element.parentNode.querySelector(`.${CART_BUTTON_SELECTOR}`);\n\n    if (!nonceElement) {\n        throw new Error('Cannot build the form data, missing security nonce.');\n    }\n\n    const nonceName = ('noncename' in nonceElement.dataset) ? nonceElement.dataset.noncename : '';\n    const nonceValue = ('noncevalue' in nonceElement.dataset) ? nonceElement.dataset.noncevalue : '';\n\n    if (!nonceName || !nonceValue) {\n        throw new Error('Cannot build the form data, missing security nonce.');\n    }\n\n    return [\n        nonceName,\n        nonceValue\n    ];\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout/smartPaymentButton.js\n\n\n\nconst SINGLE_PRODUCT_BUTTON = 'paypalplus_ecs_single_product_button';\nconst CART_BUTTON = 'paypalplus_ecs_cart_button';\n\nconst TASK_CREATE_ORDER = 'createOrder';\nconst TASK_STORE_PAYMENT_DATA = 'storePaymentData';\n\n/**\n * Class Smart Payment Button Renderer\n *\n * @type {SmartPaymentButtonRenderer}\n */\nconst smartPaymentButton_SmartPaymentButtonRenderer = class SmartPaymentButtonRenderer\n{\n    /**\n     * Constructor\n     *\n     * @param buttonConfiguration\n     * @param validContexts\n     * @param request\n     */\n    constructor(buttonConfiguration, validContexts, request)\n    {\n        this.buttonConfiguration = buttonConfiguration;\n        this.validContexts = Array.from(validContexts);\n        this.request = request;\n    }\n\n    /**\n     * Render button for single product\n     */\n    singleProductButtonRender()\n    {\n        const element = document.querySelector(`#${SINGLE_PRODUCT_BUTTON}`);\n        element && this.render(element);\n    }\n\n    /**\n     * Render Button for Cart\n     */\n    cartButtonRender()\n    {\n        const element = document.querySelector(`#${CART_BUTTON}`);\n        element && this.render(element);\n    }\n\n    /**\n     * Render Button for the Given Element\n     *\n     * @param element\n     * @returns {*}\n     */\n    // TODO Make it private\n    render(element)\n    {\n        if (_.isUndefined(paypal)) {\n            return;\n        }\n\n        paypal.Button.render({\n            ...this.buttonConfiguration,\n\n            payment: () => {\n                const formData = this.formDataByElement(element);\n                formData.append('task', TASK_CREATE_ORDER);\n\n                return this.request\n                    .submit(formData)\n                    .then(response => {\n                        const orderId = 'orderID' in response.data ? response.data.orderID : '';\n\n                        if (!orderId) {\n                            // TODO Do something to inform user about the problem and close the flow.\n                        }\n\n                        return orderId;\n                    });\n            },\n\n            onAuthorize: (data, actions) => {\n                // TODO Ensure return_url exists.\n                const formData = this.formDataByElement(element);\n\n                formData.append('task', TASK_STORE_PAYMENT_DATA);\n                formData.append('orderID', data.orderID);\n                formData.append('payerID', data.payerID);\n                formData.append('paymentID', data.paymentID);\n                formData.append('paymentToken', data.paymentToken);\n\n                return this.request\n                    .submit(formData)\n                    .then((response) => {\n                        if (response.success) {\n                            window.location.href = data.returnUrl;\n                            // TODO Block the form UI? Prevent to do stuffs.\n                        }\n\n                        // TODO Show alert to the user\n                    });\n            },\n\n            onCancel: () => {\n                console.log('ON CANCEL', arguments);\n                // TODO Update the mini cart if context is product. Unless we want to do a redirect.\n                // TODO Redirect the user to the page set in the options.\n            },\n\n            onError: () => {\n                console.log('ON ERROR', arguments);\n                // TODO Redirect to cart and show customizable notice with message.\n            },\n\n        }, element);\n    }\n\n    /**\n     * Retrieve context for FormData instance by the Given Element\n     *\n     * @param element\n     * @returns {FormData}\n     */\n    // TODO Make it private if not possible move it as closure within the render function.\n    formDataByElement(element)\n    {\n        let formData = new FormData();\n        const context = contextByElement(element);\n\n        if (!this.validContexts.includes(context)) {\n            throw new Error(\n                'Invalid context when try to retrieve the form data during express checkout request.'\n            );\n        }\n\n        try {\n            switch (context) {\n                case 'cart':\n                    formData = formDataForCart(element);\n                    break;\n                case 'product':\n                    formData = formDataByElement(element);\n                    break;\n            }\n        } catch (err) {\n        }\n\n        return formData;\n    }\n};\n\n/**\n * Smart Payment Button Renderer Factory\n *\n * @param buttonConfiguration\n * @param validContexts\n * @param request\n * @returns {SmartPaymentButtonRenderer}\n * @constructor\n */\nfunction SmartPaymentButtonRendererFactory(buttonConfiguration, validContexts, request)\n{\n    const object = new smartPaymentButton_SmartPaymentButtonRenderer(buttonConfiguration, validContexts, request);\n\n    Object.freeze(object);\n\n    return object;\n}\n\n// CONCATENATED MODULE: ./resources/js/expressCheckout.js\n\n\n\n(function (jQuery, _, expressCheckoutData) {\n    /**\n     * Ensure the Global Express Checkout is a Valid Value\n     * @returns {boolean}\n     */\n    function isValidExpressCheckoutData()\n    {\n        return !_.isUndefined(expressCheckoutData) && !_.isEmpty(expressCheckoutData);\n    }\n\n    /**\n     * Bootstrap Express checkout\n     * @returns void\n     */\n    function bootstrapExpressCheckout()\n    {\n        if (!isValidExpressCheckoutData()) {\n            return;\n        }\n\n        const requestData = expressCheckoutData.request;\n        if (!_.isObject(requestData)) {\n            return;\n        }\n\n        const validContexts = expressCheckoutData.validContexts;\n        if (!_.isArray(validContexts)) {\n            return;\n        }\n\n        const request = RequestFactory(requestData.ajaxUrl, requestData.action);\n        const smartPaymentButton = SmartPaymentButtonRendererFactory(\n            expressCheckoutData,\n            validContexts,\n            request\n        );\n\n        smartPaymentButton.singleProductButtonRender();\n        smartPaymentButton.cartButtonRender();\n        jQuery(document.body).on('wc_fragments_refreshed added_to_cart', () => {\n            smartPaymentButton.cartButtonRender();\n        });\n    }\n\n    window.addEventListener('load', () => {\n        bootstrapExpressCheckout();\n    });\n\n})(jQuery, _, window.wooPayPalPlusExpressCheckout);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L1JlcXVlc3QuanM/OGQ1ZiIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L2NvbnRleHQuanM/NjhkMyIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L2Zvcm0uanM/ZWE1ZCIsIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvZXhwcmVzc0NoZWNrb3V0L3NtYXJ0UGF5bWVudEJ1dHRvbi5qcz9mM2IyIiwid2VicGFjazovLy8uL3Jlc291cmNlcy9qcy9leHByZXNzQ2hlY2tvdXQuanM/ZGNjMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsSUFBSTs7QUFFYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ087QUFDUDtBQUNBO0FBQ0E7OztBQ1Q2Qzs7QUFFN0M7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQixnQkFBZ0I7O0FBRS9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsbUNBQW1DLGdCQUFnQjtBQUNuRDs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDhEQUE4RCxxQkFBcUI7O0FBRW5GO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNuRTREO0FBQ2Y7O0FBRTdDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxNQUFNLDZDQUEwQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsc0JBQXNCO0FBQ3pFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxZQUFZO0FBQy9EO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EscUJBQXFCO0FBQ3JCLGFBQWE7O0FBRWI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxxQkFBcUI7QUFDckIsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYixTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7O0FBRXhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGVBQWU7QUFDOUM7QUFDQTtBQUNBLCtCQUErQixpQkFBaUI7QUFDaEQ7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDTztBQUNQO0FBQ0EsdUJBQXVCLDZDQUEwQjs7QUFFakQ7O0FBRUE7QUFDQTs7O0FDdksyRDtBQUM4Qjs7QUFFekY7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHdCQUF3QixjQUFjO0FBQ3RDLG1DQUFtQyxpQ0FBaUM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUwsQ0FBQyIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDbGFzcyBSZXF1ZXN0XG4gKlxuICogQHR5cGUge1JlcXVlc3R9XG4gKi9cbmNvbnN0IFJlcXVlc3QgPSBjbGFzcyBSZXF1ZXN0XG57XG4gICAgLy8gVE9ETyBNYWtlIHRoZSBmaWVsZHMgcHJpdmF0ZSBpZiBwb3NzaWJsZS5cbiAgICBjb25zdHJ1Y3RvcihhamF4VXJsLCBhY3Rpb24pXG4gICAge1xuICAgICAgICB0aGlzLmFqYXhVcmwgPSBhamF4VXJsO1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG5cbiAgICBmb3JtRGF0YU9iamVjdChmb3JtRGF0YSlcbiAgICB7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhRW50cmllcyA9IFsuLi5mb3JtRGF0YS5lbnRyaWVzKCksIFsnYWN0aW9uJywgdGhpcy5hY3Rpb25dXTtcbiAgICAgICAgY29uc3QgZGF0YU9iamVjdCA9IGZvcm1EYXRhRW50cmllcy5yZWR1Y2UoKG9iaiwgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSwge30pO1xuXG4gICAgICAgIHJldHVybiBkYXRhT2JqZWN0O1xuICAgIH1cblxuICAgIHN1Ym1pdChmb3JtRGF0YSlcbiAgICB7XG4gICAgICAgIC8vIFRPRE8gRXh0cmFjdCBzcGVjaWZpYyBkYXRhIHN1Y2ggYXM6IGFjdGlvbiwgbm9uY2UsIHRhc2ssIGNvbnRleHQgYW5kXG4gICAgICAgIC8vICAgICAgcHV0IHRoZSByZXN0IHdpdGhpbiBhIHNwZWNpZmljIG9iamVjdC5cbiAgICAgICAgLy8gICAgICBNYWtlIGEgc2VwYXJhdGlvbiBmb3IgZGF0YSBjb250cm9scyBhbmQgcmVhbCByZXF1ZXN0IGRhdGEuXG5cbiAgICAgICAgY29uc3QgZGF0YU9iamVjdCA9IHRoaXMuZm9ybURhdGFPYmplY3QoZm9ybURhdGEpO1xuXG4gICAgICAgIGlmIChfLmlzRW1wdHkoZGF0YU9iamVjdCkpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnTm8gZm9ybURhdGEgdG8gc2VuZCB0byB0aGUgc2VydmVyLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6IHRoaXMuYWpheFVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhT2JqZWN0LFxuICAgICAgICAgICAgICAgIGVycm9yOiByZWplY3QsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogcmVzb2x2ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG4vKipcbiAqIFJlcXVlc3QgRmFjdG9yeVxuICpcbiAqIEBwYXJhbSBhamF4VXJsXG4gKiBAcGFyYW0gYWN0aW9uXG4gKiBAcmV0dXJucyB7UmVxdWVzdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIFJlcXVlc3RGYWN0b3J5KGFqYXhVcmwsIGFjdGlvbilcbntcbiAgICBpZiAoIWFqYXhVcmwgfHwgIWFjdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcGFyYW1ldGVycyB3aGVuIGNvbnN0cnVjdCBSZXF1ZXN0IGluc3RhbmNlJyk7XG4gICAgfVxuXG4gICAgbGV0IG9iamVjdCA9IG5ldyBSZXF1ZXN0KGFqYXhVcmwsIGFjdGlvbik7XG4gICAgT2JqZWN0LmZyZWV6ZShvYmplY3QpO1xuXG4gICAgcmV0dXJuIG9iamVjdDtcbn1cbiIsIi8qKlxuICogUmV0cmlldmUgQ29udGV4dCBieSBFbGVtZW50XG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb250ZXh0QnlFbGVtZW50KGVsZW1lbnQpXG57XG4gICAgcmV0dXJuICgnY29udGV4dCcgaW4gZWxlbWVudC5kYXRhc2V0ID8gZWxlbWVudC5kYXRhc2V0LmNvbnRleHQgOiAnJyk7XG59XG4iLCJpbXBvcnQgeyBjb250ZXh0QnlFbGVtZW50IH0gZnJvbSAnLi9jb250ZXh0JztcblxuY29uc3QgQ0FSVF9CVVRUT05fU0VMRUNUT1IgPSAnd29vLXBheXBhbHBsdXMtY2hlY2tvdXQtbm9uY2UnO1xuXG4vKipcbiAqIENyZWF0ZSBhIEZvcm1EYXRhIG9iamVjdCBieSB0aGUgY2xvc2VzdCBmb3JtIG9mIHRoZSBnaXZlbiBlbGVtZW50XG4gKlxuICogQHBhcmFtIGVsZW1lbnRcbiAqIEByZXR1cm5zIHtGb3JtRGF0YX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1EYXRhQnlFbGVtZW50KGVsZW1lbnQpXG57XG4gICAgY29uc3QgZm9ybSA9IGVsZW1lbnQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgaWYgKCFmb3JtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICdVbmFibGUgdG8gcmV0cmlldmUgZm9ybS4gRm9ybSBlbGVtZW50IGRvZXMgbm90IGV4aXN0cyBvciBpcyBub3QgYSBwYXJlbnQgb2YgdGhlIGdpdmVuIGVsZW1lbnQuJ1xuICAgICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgnY29udGV4dCcsIGNvbnRleHRCeUVsZW1lbnQoZWxlbWVudCkpO1xuXG4gICAgcmV0dXJuIGZvcm1EYXRhO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIEZvcm1EYXRhIGZvciB0aGUgQ2FydFxuICogV29vQ29tbWVyY2UgbWluaSBjYXJ0IGRvZXNuJ3QgaGF2ZSBhbnkgZm9ybSBhc3NvY2lhdGVkIHdpdGggaXRcbiAqXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHJldHVybnMge0Zvcm1EYXRhfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybURhdGFGb3JDYXJ0KGVsZW1lbnQpXG57XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgW25vbmNlTmFtZSwgbm9uY2VWYWx1ZV0gPSByZXRyaWV2ZU5vbmNlRm9yQ2FydChlbGVtZW50KTtcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcblxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NvbnRleHQnLCBjb250ZXh0QnlFbGVtZW50KGVsZW1lbnQpKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKG5vbmNlTmFtZSwgbm9uY2VWYWx1ZSk7XG5cbiAgICAgICAgcmV0dXJuIGZvcm1EYXRhO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gbmV3IEZvcm1EYXRhKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZXRyaWV2ZU5vbmNlRm9yQ2FydChlbGVtZW50KVxue1xuICAgIGNvbnN0IG5vbmNlRWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKGAuJHtDQVJUX0JVVFRPTl9TRUxFQ1RPUn1gKTtcblxuICAgIGlmICghbm9uY2VFbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGJ1aWxkIHRoZSBmb3JtIGRhdGEsIG1pc3Npbmcgc2VjdXJpdHkgbm9uY2UuJyk7XG4gICAgfVxuXG4gICAgY29uc3Qgbm9uY2VOYW1lID0gKCdub25jZW5hbWUnIGluIG5vbmNlRWxlbWVudC5kYXRhc2V0KSA/IG5vbmNlRWxlbWVudC5kYXRhc2V0Lm5vbmNlbmFtZSA6ICcnO1xuICAgIGNvbnN0IG5vbmNlVmFsdWUgPSAoJ25vbmNldmFsdWUnIGluIG5vbmNlRWxlbWVudC5kYXRhc2V0KSA/IG5vbmNlRWxlbWVudC5kYXRhc2V0Lm5vbmNldmFsdWUgOiAnJztcblxuICAgIGlmICghbm9uY2VOYW1lIHx8ICFub25jZVZhbHVlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGJ1aWxkIHRoZSBmb3JtIGRhdGEsIG1pc3Npbmcgc2VjdXJpdHkgbm9uY2UuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFtcbiAgICAgICAgbm9uY2VOYW1lLFxuICAgICAgICBub25jZVZhbHVlXG4gICAgXTtcbn1cbiIsImltcG9ydCB7IGZvcm1EYXRhQnlFbGVtZW50LCBmb3JtRGF0YUZvckNhcnQgfSBmcm9tICcuL2Zvcm0nO1xuaW1wb3J0IHsgY29udGV4dEJ5RWxlbWVudCB9IGZyb20gJy4vY29udGV4dCc7XG5cbmNvbnN0IFNJTkdMRV9QUk9EVUNUX0JVVFRPTiA9ICdwYXlwYWxwbHVzX2Vjc19zaW5nbGVfcHJvZHVjdF9idXR0b24nO1xuY29uc3QgQ0FSVF9CVVRUT04gPSAncGF5cGFscGx1c19lY3NfY2FydF9idXR0b24nO1xuXG5jb25zdCBUQVNLX0NSRUFURV9PUkRFUiA9ICdjcmVhdGVPcmRlcic7XG5jb25zdCBUQVNLX1NUT1JFX1BBWU1FTlRfREFUQSA9ICdzdG9yZVBheW1lbnREYXRhJztcblxuLyoqXG4gKiBDbGFzcyBTbWFydCBQYXltZW50IEJ1dHRvbiBSZW5kZXJlclxuICpcbiAqIEB0eXBlIHtTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlcn1cbiAqL1xuY29uc3QgU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXIgPSBjbGFzcyBTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlclxue1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYnV0dG9uQ29uZmlndXJhdGlvblxuICAgICAqIEBwYXJhbSB2YWxpZENvbnRleHRzXG4gICAgICogQHBhcmFtIHJlcXVlc3RcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihidXR0b25Db25maWd1cmF0aW9uLCB2YWxpZENvbnRleHRzLCByZXF1ZXN0KVxuICAgIHtcbiAgICAgICAgdGhpcy5idXR0b25Db25maWd1cmF0aW9uID0gYnV0dG9uQ29uZmlndXJhdGlvbjtcbiAgICAgICAgdGhpcy52YWxpZENvbnRleHRzID0gQXJyYXkuZnJvbSh2YWxpZENvbnRleHRzKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgYnV0dG9uIGZvciBzaW5nbGUgcHJvZHVjdFxuICAgICAqL1xuICAgIHNpbmdsZVByb2R1Y3RCdXR0b25SZW5kZXIoKVxuICAgIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke1NJTkdMRV9QUk9EVUNUX0JVVFRPTn1gKTtcbiAgICAgICAgZWxlbWVudCAmJiB0aGlzLnJlbmRlcihlbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgQnV0dG9uIGZvciBDYXJ0XG4gICAgICovXG4gICAgY2FydEJ1dHRvblJlbmRlcigpXG4gICAge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Q0FSVF9CVVRUT059YCk7XG4gICAgICAgIGVsZW1lbnQgJiYgdGhpcy5yZW5kZXIoZWxlbWVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIEJ1dHRvbiBmb3IgdGhlIEdpdmVuIEVsZW1lbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgLy8gVE9ETyBNYWtlIGl0IHByaXZhdGVcbiAgICByZW5kZXIoZWxlbWVudClcbiAgICB7XG4gICAgICAgIGlmIChfLmlzVW5kZWZpbmVkKHBheXBhbCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHBheXBhbC5CdXR0b24ucmVuZGVyKHtcbiAgICAgICAgICAgIC4uLnRoaXMuYnV0dG9uQ29uZmlndXJhdGlvbixcblxuICAgICAgICAgICAgcGF5bWVudDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YUJ5RWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3Rhc2snLCBUQVNLX0NSRUFURV9PUkRFUik7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgIC5zdWJtaXQoZm9ybURhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9yZGVySWQgPSAnb3JkZXJJRCcgaW4gcmVzcG9uc2UuZGF0YSA/IHJlc3BvbnNlLmRhdGEub3JkZXJJRCA6ICcnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9yZGVySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIERvIHNvbWV0aGluZyB0byBpbmZvcm0gdXNlciBhYm91dCB0aGUgcHJvYmxlbSBhbmQgY2xvc2UgdGhlIGZsb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcklkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG9uQXV0aG9yaXplOiAoZGF0YSwgYWN0aW9ucykgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFRPRE8gRW5zdXJlIHJldHVybl91cmwgZXhpc3RzLlxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YUJ5RWxlbWVudChlbGVtZW50KTtcblxuICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGFzaycsIFRBU0tfU1RPUkVfUEFZTUVOVF9EQVRBKTtcbiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ29yZGVySUQnLCBkYXRhLm9yZGVySUQpO1xuICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgncGF5ZXJJRCcsIGRhdGEucGF5ZXJJRCk7XG4gICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwYXltZW50SUQnLCBkYXRhLnBheW1lbnRJRCk7XG4gICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwYXltZW50VG9rZW4nLCBkYXRhLnBheW1lbnRUb2tlbik7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgIC5zdWJtaXQoZm9ybURhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEucmV0dXJuVXJsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE8gQmxvY2sgdGhlIGZvcm0gVUk/IFByZXZlbnQgdG8gZG8gc3R1ZmZzLlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIFNob3cgYWxlcnQgdG8gdGhlIHVzZXJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPTiBDQU5DRUwnLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8gVXBkYXRlIHRoZSBtaW5pIGNhcnQgaWYgY29udGV4dCBpcyBwcm9kdWN0LiBVbmxlc3Mgd2Ugd2FudCB0byBkbyBhIHJlZGlyZWN0LlxuICAgICAgICAgICAgICAgIC8vIFRPRE8gUmVkaXJlY3QgdGhlIHVzZXIgdG8gdGhlIHBhZ2Ugc2V0IGluIHRoZSBvcHRpb25zLlxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgb25FcnJvcjogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPTiBFUlJPUicsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyBSZWRpcmVjdCB0byBjYXJ0IGFuZCBzaG93IGN1c3RvbWl6YWJsZSBub3RpY2Ugd2l0aCBtZXNzYWdlLlxuICAgICAgICAgICAgfSxcblxuICAgICAgICB9LCBlbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBjb250ZXh0IGZvciBGb3JtRGF0YSBpbnN0YW5jZSBieSB0aGUgR2l2ZW4gRWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7Rm9ybURhdGF9XG4gICAgICovXG4gICAgLy8gVE9ETyBNYWtlIGl0IHByaXZhdGUgaWYgbm90IHBvc3NpYmxlIG1vdmUgaXQgYXMgY2xvc3VyZSB3aXRoaW4gdGhlIHJlbmRlciBmdW5jdGlvbi5cbiAgICBmb3JtRGF0YUJ5RWxlbWVudChlbGVtZW50KVxuICAgIHtcbiAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjb250ZXh0QnlFbGVtZW50KGVsZW1lbnQpO1xuXG4gICAgICAgIGlmICghdGhpcy52YWxpZENvbnRleHRzLmluY2x1ZGVzKGNvbnRleHQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgJ0ludmFsaWQgY29udGV4dCB3aGVuIHRyeSB0byByZXRyaWV2ZSB0aGUgZm9ybSBkYXRhIGR1cmluZyBleHByZXNzIGNoZWNrb3V0IHJlcXVlc3QuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjYXJ0JzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEgPSBmb3JtRGF0YUZvckNhcnQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2R1Y3QnOlxuICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YSA9IGZvcm1EYXRhQnlFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZm9ybURhdGE7XG4gICAgfVxufTtcblxuLyoqXG4gKiBTbWFydCBQYXltZW50IEJ1dHRvbiBSZW5kZXJlciBGYWN0b3J5XG4gKlxuICogQHBhcmFtIGJ1dHRvbkNvbmZpZ3VyYXRpb25cbiAqIEBwYXJhbSB2YWxpZENvbnRleHRzXG4gKiBAcGFyYW0gcmVxdWVzdFxuICogQHJldHVybnMge1NtYXJ0UGF5bWVudEJ1dHRvblJlbmRlcmVyfVxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBTbWFydFBheW1lbnRCdXR0b25SZW5kZXJlckZhY3RvcnkoYnV0dG9uQ29uZmlndXJhdGlvbiwgdmFsaWRDb250ZXh0cywgcmVxdWVzdClcbntcbiAgICBjb25zdCBvYmplY3QgPSBuZXcgU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXIoYnV0dG9uQ29uZmlndXJhdGlvbiwgdmFsaWRDb250ZXh0cywgcmVxdWVzdCk7XG5cbiAgICBPYmplY3QuZnJlZXplKG9iamVjdCk7XG5cbiAgICByZXR1cm4gb2JqZWN0O1xufVxuIiwiaW1wb3J0IHsgUmVxdWVzdEZhY3RvcnkgfSBmcm9tICcuL2V4cHJlc3NDaGVja291dC9SZXF1ZXN0JztcbmltcG9ydCB7IFNtYXJ0UGF5bWVudEJ1dHRvblJlbmRlcmVyRmFjdG9yeSB9IGZyb20gJy4vZXhwcmVzc0NoZWNrb3V0L3NtYXJ0UGF5bWVudEJ1dHRvbic7XG5cbihmdW5jdGlvbiAoalF1ZXJ5LCBfLCBleHByZXNzQ2hlY2tvdXREYXRhKSB7XG4gICAgLyoqXG4gICAgICogRW5zdXJlIHRoZSBHbG9iYWwgRXhwcmVzcyBDaGVja291dCBpcyBhIFZhbGlkIFZhbHVlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNWYWxpZEV4cHJlc3NDaGVja291dERhdGEoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuICFfLmlzVW5kZWZpbmVkKGV4cHJlc3NDaGVja291dERhdGEpICYmICFfLmlzRW1wdHkoZXhwcmVzc0NoZWNrb3V0RGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQm9vdHN0cmFwIEV4cHJlc3MgY2hlY2tvdXRcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgZnVuY3Rpb24gYm9vdHN0cmFwRXhwcmVzc0NoZWNrb3V0KClcbiAgICB7XG4gICAgICAgIGlmICghaXNWYWxpZEV4cHJlc3NDaGVja291dERhdGEoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdERhdGEgPSBleHByZXNzQ2hlY2tvdXREYXRhLnJlcXVlc3Q7XG4gICAgICAgIGlmICghXy5pc09iamVjdChyZXF1ZXN0RGF0YSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbGlkQ29udGV4dHMgPSBleHByZXNzQ2hlY2tvdXREYXRhLnZhbGlkQ29udGV4dHM7XG4gICAgICAgIGlmICghXy5pc0FycmF5KHZhbGlkQ29udGV4dHMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gUmVxdWVzdEZhY3RvcnkocmVxdWVzdERhdGEuYWpheFVybCwgcmVxdWVzdERhdGEuYWN0aW9uKTtcbiAgICAgICAgY29uc3Qgc21hcnRQYXltZW50QnV0dG9uID0gU21hcnRQYXltZW50QnV0dG9uUmVuZGVyZXJGYWN0b3J5KFxuICAgICAgICAgICAgZXhwcmVzc0NoZWNrb3V0RGF0YSxcbiAgICAgICAgICAgIHZhbGlkQ29udGV4dHMsXG4gICAgICAgICAgICByZXF1ZXN0XG4gICAgICAgICk7XG5cbiAgICAgICAgc21hcnRQYXltZW50QnV0dG9uLnNpbmdsZVByb2R1Y3RCdXR0b25SZW5kZXIoKTtcbiAgICAgICAgc21hcnRQYXltZW50QnV0dG9uLmNhcnRCdXR0b25SZW5kZXIoKTtcbiAgICAgICAgalF1ZXJ5KGRvY3VtZW50LmJvZHkpLm9uKCd3Y19mcmFnbWVudHNfcmVmcmVzaGVkIGFkZGVkX3RvX2NhcnQnLCAoKSA9PiB7XG4gICAgICAgICAgICBzbWFydFBheW1lbnRCdXR0b24uY2FydEJ1dHRvblJlbmRlcigpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgYm9vdHN0cmFwRXhwcmVzc0NoZWNrb3V0KCk7XG4gICAgfSk7XG5cbn0pKGpRdWVyeSwgXywgd2luZG93Lndvb1BheVBhbFBsdXNFeHByZXNzQ2hlY2tvdXQpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n")}]);
//# sourceMappingURL=expressCheckout.min.js.map